#include <Arduino.h>
#include <HX711.h>

const int LOADCELL_DOUT_PIN = 5;
const int LOADCELL_SCK_PIN = 18;

unsigned long int tempoAnterior = 0;
unsigned long int tempoAtual = millis();

HX711 scale;

// DECLARAÇÃO DE VARIÁVEIS
float medida = 0;

void setup()
{
  Serial.begin(9600);

  scale.begin(LOADCELL_DOUT_PIN, LOADCELL_SCK_PIN); // CONFIGURANDO OS PINOS DA BALANÇA
  scale.set_scale(41795);                           // LIMPANDO O VALOR DA ESCALA

  delay(2000);
  scale.tare(); // ZERANDO A BALANÇA PARA DESCONSIDERAR A MASSA DA ESTRUTURA

  Serial.println("Balança Zerada");

  scale.power_up(); // LIGANDO O SENSOR
}

void loop()
{
  unsigned long tempoAtual = millis();

  medida = scale.get_units(5); // SALVANDO NA VARIAVEL O VALOR DA MÉDIA DE 5 MEDIDAS

  if (tempoAtual - tempoAnterior >= 5000)
  {
    if (medida < 0)
    {
      medida = 0;
      Serial.println(medida, 2);
    }
    else
    {
      Serial.println(medida, 2); // ENVIANDO PARA MONITOR SERIAL A MEDIDA COM 3 CASAS DECIMAIS
    }
     tempoAnterior = tempoAtual;
  }
 
}
